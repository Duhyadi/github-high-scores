function process_form(t){sanitize_url(t).then(function(t){var r=validator.isURL(t,{protocols:["http","https"],allow_underscores:!0});if(r){var e=get_user_from_github_url(t),n=get_repo_from_github_url(t);window.location=window.location.origin+window.location.pathname+"#"+e+"/"+n,location.reload()}else""!==t&&process_error()},function(t){process_error()})}function process_error(){document.write("error")}function render(){var t=window.location.hash.replace("#","").split("/"),r=t[0],e=t[1];get_high_scores(r,e).then(function(t){var r={title:"My New Post",body:"This is my first post!"},e=template(r);document.write(e)})}function get_user_from_github_url(t){return t.split("/")[3]}function get_repo_from_github_url(t){return t.split("/")[4]}function get_high_scores(t,r){return new Promise(function(e,n){get_contributors(t,r).then(function(t){Promise.all(t.map(function(t){return{username:t.login,score:100*t.contributions,avatar:t.avatar_url}})).then(function(t){e(t)})}).catch(function(t){return"undefined"==typeof t?void n("Repository not found"):void n(t)})})}function get_contributors(t,r){return new Promise(function(e,n){try{var o={host:"api.github.com",path:"/repos/"+t+"/"+r+"/contributors"},i=function(t){var r="";t.on("data",function(t){r+=t}),t.on("end",function(){e(JSON.parse(r))})};https.request(o,i).end()}catch(t){n("test:"+t)}})}function sanitize_url(t){return new Promise(function(r,e){if("undefined"==typeof t||""===t)return void e("No query");var n=t.toLowerCase();"github.com"===n.substring(0,10)?n="https://www.github.com"+n.substring(10):"www.github.com"===n.substring(0,14)&&(n="https://www.github.com"+n.substring(14)),".git"===n.substring(n.length-4)&&(n=n.substring(0,n.length-4)),n=n.replace("http://","https://").replace("git@github.com:","https://www.github.com/").replace("git://","https://www."),tokens=n.replace(/^\/|\/$/g,"").split("/"),2===tokens.length&&(n="https://www.github.com/"+tokens[0]+"/"+tokens[1]),r(n)})}var validator=require("validator"),https=require("https");if(require("handlebars"),window.location.href.indexOf("#")>-1)render();else{var form="<form action='' id='form'>\n\t<input type='text' name='url' />\n\t<input type='submit'/>\n</form>\n";document.write(form),document.getElementById("form").onsubmit=function(t){return t.preventDefault(),process_form(document.getElementById("form").url.value),!1}}